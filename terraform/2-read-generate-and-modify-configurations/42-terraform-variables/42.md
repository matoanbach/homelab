## Variables 
- Managing variables in production environment is one of the very important aspect to keep code clean and reusable
- HashiCorp recommends creating a separate file with name of `*.tfvars` to define all variable value in a project

## Recommended Folder Structure
1. Main Terraform Configuration File.
```
resource "aws_vpc_security_group_ingress_rule" "allow_tls_ipv4" {
    security_group_id = aws_security_group.allow_tls.id
    cidr_ipv4 = var.vpn_ip
    from_port = var.app_port
    ip_protocol = "tcp"
    to_port = var.app_port
}
```
2. `variables.tf` file that defines all the variables.
```
variable "vpn_ip" {}
variable "app_port" {}
variable "instance_type" {}
```
3. `terraform.tfvars` file that defines value to all the variables
- Organizations can have wide set of environments: Dev, Stage, Prod
- Dev env - dev.tfvars
 ```
vpn_ip = "52.0.62.30/32"
app_port = "8080"
instance_type = "t2.micro" 
```

- Prod env - prod.tfvars
```
vpn_ip = "101.0.62.30/32"
app_port = "8080"
instance_type = "m5.large" 
```

## Selecting tfvars file
- If you have multiple variable definition files (*.tfvars) file, you can manually define the file to use during command line.
```bash
terraform plan -var-file="prod.tfvars"
```

## Notes
- If file name is terraform.tfvars -> Terraform will automatically load values from it.
- If file name is different like prod.tfvars -> You have to explicitly define the file during plan / apply operation.

## Setting Variable in Command Line
- To specify individual variables on the command line, use `-var` option when running the `terraform plan` and `terraform apply` commands. E.g., `terraform plan -var="instance_type=m5.large"`

## Variable Definition Precedence
- Terraform loads variables in the following order, with later sources taking precedence over earlier ones:
1. Environment variables
2. `terraform.tfvars` file
3. `terraform.tfvars.json` file
4. any `*auto.tfvars` or `*.auto.tfvars.json` files, processed in lexical order of their filenames
5. Any `-var` and `-var-file` options on the command line

### Example 1 
- Env Variable of TF_VAR_instance_type = "t2.micro"
- Value in terraform.tfvars = "t2.large"
- Final Result = "t2.large"

### Example 2
- ENV Variable of TF_VAR_instance_type = "t2.micro"
- Value in terrafom.tfvars = "t2.large"
- `terraform plan -var="instance_type=m5.large"`
- Final Result = "m5.large"