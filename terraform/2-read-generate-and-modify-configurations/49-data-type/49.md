# Data Types
## List
- Allow ust to store collection of values for a single variable / argument.
- Represented by a pair of square brackets containing a comma-seperated sequence of values, like ["a", 15, true]
- Useful when multiple values need to be added for a specific argument
```
variable "my-list" {
    type = list
    default = ["mumbai", "bangalore", "delhi"]
}
```
- Arguments for a resource requires specific data types.
- Some argument requires list, some requires map and so on.
- The details of data type expected from an argument is mentioned in documentation.

## Count Index
- The count argument accepts a while number, and creates that many instances of the resource
```
resource "aws_instance" "second_ec2" {
    ami = "ami-..."
    instance_type = "t2.micro"
    count = 3
}
```

### Count Index
- When using count, you can also make use of `count.index` which allows better flexibility.
- This attribute holds a distinct index number, starting from 0, that uniquely identifies each instance created by the count meta-argument.
- Example - IAM Users
    - The `${count.index}` is dynamic expression that utilizes the count.index attribute so that each username will be unique
    ```
    resource "aws_iam_user" "lb" {
        name "developer-user.${count.index}"
        count = 3
    }
    ```
- Example
```
variable "dev_names" {
    type = list
    default = ["alice", "bob", "johncorner"]
}

resource "aws_iam_user" "lb" {
    name = var.dev_names[count.index]
    count = e
}
```

## Map
- A map data type represents a collection of key-value pair elements
```
variable "instance_tags" {
    type = map 
    default = {
        Name = "app-server"
        Environment = "development"
        Team = "payment"
    }
}
```
- We can add multiple tags to AWS resources
- These tags are key-value pairs


## Conditional Expressions

### Conditional Expressison Based on Use-case
```
variable "environment" {
    default = "development"
}

resource "aws_instance" "example" {
    instance_type = var.environment == "development" ? "t2.micro" : "m5.large"
    ami = "ami-..."
}
```

### Conditional Expression with Multiple Variables
```
variable "environment" {
    default = "production"
}

variable "region" {
    default = "ap-south-1"
}

resource "aws_instance" "example" {
    instance_type = var.environment == "production" && var.region == "us-east-1" ? "m5.large" : "t2.micro"
    ami = "ami-..."
}
```

## Terraform Functions
- A function is a block of code that performs a specific task
- Terraform has a wide variety of functions available to achieve different set of use-cases
- Functions are grouped into categories. Some of these include:
| Function Categories  | Available Functions                      |
|----------------------|------------------------------------------|
| Numberic functions   | abs, ceil, floor, max, min               |
| String functions     | concat, replace, split, tolower, toupper |
| Collection functions | element, keys, length, merge, sort       |
| Filesystem functions | file, filebase64, dirname                |

### Importance of File Function
- `file()` reads the contents of a file at the given path and returns them as a string.
- Before
```json
resource "aws_iam_user_policy" "lb_ro" {
    name = "demo-user-policy"
    user = aws_iam_user.this.name
    policy = jsonencode({
        "Version": "2012-10-17",
        "Statement" : [
            {
                "Action": "ec2:*",
                "Effect": "Allow",
                "Resource": "*"
            },
            {
                "Action": "elasticloadbalancing",
                "Effect": "Allow",
                "Resource": "*"
            },
        ]
    })
}
```
- After using file()
```tf
resource "aws_iam_user_policy" "lb_ro" {
    name = "demo-user-policy"
    user = aws_iam_user.this.name
    policy = file("./ec2-policy.json")
}
```

## Notes
- Terraform does not support user-defined functions, and so only the functions built in to the language are available for use
- The documentation includes a page for all of the available built-in functions.